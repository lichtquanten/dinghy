services:
  api:
    build:
      target: development
    ports:
      - "${WEB_HOST_PORT:-5173}:${WEB_CONTAINER_PORT:-5173}"
    healthcheck:
      test:
        [
          "CMD-SHELL",
          "wget --no-verbose --tries=1 --spider http://localhost:${API_CONTAINER_PORT:-3000}/api/health && wget --no-verbose --tries=1 --spider http://localhost:${WEB_CONTAINER_PORT:-5173}/ || exit 1",
        ]
    volumes:
      - ./apps/api/src:/app/apps/api/src
      - ./packages/ai-models/src:/app/packages/ai-models/src
      - ./packages/code-languages/src:/app/packages/code-languages/src
      - ./packages/database/src:/app/packages/database/src
      - ./apps/web/src:/app/apps/web/src
      - ./apps/web/public:/app/apps/web/public
      - ./apps/web/index.html:/app/apps/web/index.html
      - ./packages/ui/src:/app/packages/ui/src
    stdin_open: true
    tty: true
